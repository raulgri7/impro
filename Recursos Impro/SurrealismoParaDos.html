<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surrealismo para Dos (Generador de Imprvs.)</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 700px; margin: 0 auto; background-color: #f4f7f6; }
        h1 { color: #4285f4; border-bottom: 2px solid #4285f4; padding-bottom: 10px; margin-bottom: 30px; }
        
        button { 
            padding: 14px 25px; 
            background-color: #4285f4; 
            color: white; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 18px; 
            font-weight: bold;
            transition: background-color 0.3s, transform 0.1s; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
        }
        button:hover { background-color: #3367d6; }
        button:active { transform: translateY(2px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        
        #resultado { 
            margin-top: 35px; 
            padding: 25px; 
            border: 2px solid #4285f4; 
            background-color: #eaf3ff; 
            border-radius: 10px; 
            min-height: 100px; 
            white-space: pre-wrap; 
            font-size: 1.15em; 
        }
        pre { 
            font-family: inherit; 
            margin: 0; 
            padding: 0; 
            white-space: pre-wrap; 
            line-height: 1.7; 
            font-weight: bold; 
        }
        .cargando { color: #4285f4; font-weight: bold; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <h1>Surrealismo para dos üé≠</h1>
    
    <button onclick="generarImpro()">¬° Dame una Idea !</button>
    
    <div id="resultado"></div>


    <script>
        // ----------------------------------------------------------
        // --- CLAVE API Y CONFIGURACI√ìN ---
        // ----------------------------------------------------------
        const API_KEY = 'AIzaSyBkw_hSk8yJdruIH-mOPWTvd4v7qVh-EyQ'; // ¬°RECUERDA SUSTITUIR ESTO!
        const MODEL_NAME = 'gemini-2.5-flash';
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${API_KEY}`;


        // Funci√≥n para construir el PROMPT detallado y mejorado
        function construirPromptFinal() {
            // [CAMBIO CLAVE] Se modific√≥ el requisito de la emoci√≥n a "simples y directas"
            const contexto = `Eres un experto en teatro de improvisaci√≥n y generas ideas para un juego para una PAREJA DE ACTORES (dos personajes). La situaci√≥n debe ser: surrealista, cotidiana y tratada por los personajes de forma **absolutamente realista, seria y sin sorpresa**. Debe incluir una lista de exactamente 3 emociones **simples y directas** para explorar.

EL FORMATO DEBE SER ESTRICTAMENTE DE DOS L√çNEAS √öNICAS:
1. La situaci√≥n completa.
‚Üí Emoci√≥n: [Emoci√≥n 1], [Emoci√≥n 2], [Emoci√≥n 3].

No a√±adas NING√öN otro texto, explicaciones, introducciones, encabezados, despedidas o comentarios. Solo el resultado formateado de dos l√≠neas.`;

            // [CAMBIO CLAVE] Ejemplos actualizados con emociones simplificadas
            const ejemplos = [
                "1. Una pareja discute porque el beb√© que han adoptado es‚Ä¶ un drag√≥n.\n‚Üí Emoci√≥n: amor, horror, curiosidad.",
                "2. Dos compa√±eros de piso tienen una charla seria mientras su nevera levita lentamente hacia el techo.\n‚Üí Emoci√≥n: intimidad, distracci√≥n, resignaci√≥n.",
                "3. Dos cirujanos intentan operar a coraz√≥n abierto a un osito de peluche.\n‚Üí Emoci√≥n: concentraci√≥n, estr√©s, compasi√≥n.",
                "4. Dos compa√±eros de oficina tienen una discusi√≥n acalorada sobre qui√©n se comi√≥ el √∫ltimo yogurt en la cocina mientras, a sus espaldas, un agujero negro est√° absorbiendo el archivador.\n‚Üí Emoci√≥n: competitividad, indiferencia, fascinaci√≥n.",
                "5. Una pareja en un restaurante de lujo celebra su aniversario, mientras la copa de vino de uno de ellos empieza a hablar sobre su crisis existencial.\n‚Üí Emoci√≥n: verg√ºenza, empat√≠a, pena.",
                "6. Dos jardineros est√°n regando tranquilamente un seto que, cada vez que lo tocan, emite el sonido de un beb√© llorando desconsoladamente.\n‚Üí Emoci√≥n: molestia, instinto protector, ternura."
            ];

            // [CAMBIO CLAVE] Instrucci√≥n final sin forzar el n√∫mero '7.'
            const instruccionFinal = "Genera un NUEVO y original ejemplo para dos actores que siga este formato estricto de dos l√≠neas exactas.";

            return `${contexto}\n\n${ejemplos.join('\n')}\n\n${instruccionFinal}`;
        }

        // Funci√≥n principal para llamar a la API
        async function generarImpro() {
            const resultadoDiv = document.getElementById('resultado');
            resultadoDiv.innerHTML = '<span class="cargando">Generando la idea surrealista para dos...</span>';
            
            const prompt = construirPromptFinal();
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{ role: "user", parts: [{ text: prompt }] }],
                        generationConfig: { 
                            temperature: 0.9, 
                            maxOutputTokens: 2048, 
                        }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({error: {message: 'Respuesta de error no es JSON'}}));
                    throw new Error(`Error ${response.status}: ${errorData.error ? errorData.error.message : response.statusText}`);
                }

                const data = await response.json();
                
                // --- EXTRACCI√ìN Y LIMPIEZA DEL TEXTO ---
                let textoGenerado = "No se pudo generar el contenido. Vuelve a intentarlo o revisa el diagn√≥stico de la API.";

                try {
                    // Intenta extraer el texto generado y lo limpia de posibles espacios o caracteres no deseados
                    textoGenerado = data.candidates[0].content.parts[0].text.trim();
                } catch (e) {
                    // Si falla (por contenido vac√≠o o safety block)
                }
                // ----------------------------------------------------

                // Muestra el resultado final
                resultadoDiv.innerHTML = `
                    <pre>${textoGenerado}</pre>
                `;

            } catch (error) {
                // Manejo de ERRORES CR√çTICOS
                resultadoDiv.innerHTML = `
                    <strong style="color: #c53929;">Error cr√≠tico al conectar con la API:</strong> ${error.message}.<br><br>
                    <strong>POSIBLES CAUSAS:</strong><br>
                    - Clave API incorrecta o expirada.<br>
                    - Falta de cr√©ditos o restricci√≥n de uso.<br>
                    - El modelo no est√° disponible o el nombre es incorrecto.
                `;
            }
        }
    </script>


<hr style="margin-top: 40px; border-color: #ccc;">
    <div style="text-align: center; margin-top: 20px; padding-bottom: 20px;">
        <a href="index.html" style="
            text-decoration: none;
            color: #5f6368;
            font-weight: bold;
            padding: 10px 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            transition: background-color 0.3s;
        ">
            ‚Üê Volver al Men√∫ Principal
        </a>
    </div>

</body>
</html>